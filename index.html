<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Brownian Motion Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://cdn.tailwindcss.com"></script>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          tags: 'ams',
        },
      };
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
      async
    ></script>
    <style>
      body p {
        text-align: justify;
        margin-bottom: 1.5rem !important;
      }

      footer p {
        text-align: justify;
        margin-bottom: 0 !important;
      }
    </style>
  </head>





  <body class="bg-gray-900 text-gray-100 font-sans">
    <main class="max-w-3xl mx-auto p-8 space-y-8">



      <!-- Title -->
      <header>
        <h1 class="text-3xl font-bold">Brownian Motion</h1>
      </header>



      <!-- Quote -->
      <p class="italic">
        "If, in some cataclysm, all of scientific knowledge were to be destroyed, and only one sentence passed on to the next generation of creatures, what statement would contain the most information in the fewest words?
        I believe it is the <strong>atomic hypothesis</strong> [...] that all things are made of atoms — little particles that move around in perpetual motion, attracting each other when they are a little distance apart, but repelling upon being squeezed into one another."<sup><a href="#feynman-1963" class="text-blue-300 hover:underline">[1]</a></sup>
      </p>
      <p class="text-right text-gray-400">— Richard Feynman</p>



      <!-- Navigation Menu -->
      <nav class="mb-8 p-4 bg-gray-800 rounded shadow-md">
        <h2 class="text-lg font-semibold mb-2">Jump to Section:</h2>
        <ul class="space-y-1 text-sm text-blue-300 list-disc list-inside">
          <li><a href="#background" class="hover:underline">Historical Background</a></li>
          <li><a href="#theory" class="hover:underline">Theory</a></li>
          <li><a href="#pre-lab-questions" class="hover:underline">Pre-Lab Questions</a></li>
        </ul>
      </nav>



      <!-- Section: Historical Background -->
      <details id="background" open class="mb-8">
        <summary class="text-xl font-bold cursor-pointer hover:text-blue-300">
          Historical Background
        </summary>
        <div class="mt-4 space-y-6">

          <p>
            In 1827, Scottish botanist Robert Brown, while investigating the structure and fertilization role of pollen grains, observed that wildflower pollen contained tiny spherical particles that moved erratically when suspended in water.
            He determined that this motion was not caused by external factors such as evaporation or fluid currents, as the motion persisted under conditions where such influences were absent.
            Extending his observations beyond pollen, Brown discovered the same erratic motion in a wide variety of substances, including plant and animal tissues, fossilized wood, volcanic ash, and even powdered minerals like glass and obsidian<sup><a href="#brown-1828" class="text-blue-300 hover:underline">[2]</a></sup>.
            This seemingly spontaneous and universal motion of microscopic particles became known as <strong>Brownian motion</strong> in his honor.
          </p>

          <p>
            Although the physical origin of Brownian motion remained uncertain throughout the 19th century, early developments in kinetic theory and probability—alongside mathematical formulations of random processes—laid the groundwork for Einstein’s landmark 1905 paper, “On the Movement of Small Particles Suspended in a Stationary Liquid Demanded by the Molecular-Kinetic Theory of Heat”<sup><a href="#einstein-1956" class="text-blue-300 hover:underline">[3]</a></sup>.
            In this work, Einstein provided a quantitative framework linking the erratic motion of suspended particles to molecular collisions, deriving a relation between the diffusion coefficient and measurable physical quantities such as temperature, viscosity, and particle size.
            His theory not only explained the mechanism behind Brownian motion but also offered a method to estimate Avogadro’s number, lending strong support to the atomic theory of matter.
            This theoretical advance was experimentally confirmed by Jean Perrin in the years that followed, through meticulous observations of suspended particles that matched Einstein’s predictions<sup><a href="#perrin-1910" class="text-blue-300 hover:underline">[4]</a></sup>.
            Perrin’s work provided decisive empirical validation of molecular reality and earned him the Nobel Prize in Physics in 1926.
          </p>

        </div>
      </details>



      <!-- Section: Theory -->
      <details id="theory" class="mb-8">
        <summary class="text-xl font-bold cursor-pointer hover:text-blue-300">
          Theory
        </summary>
        <div class="mt-4 space-y-6">

          <p>
            Before diving into the physics behind Brownian motion, it’s helpful to first consider the mathematical framework used to describe it.
            In most of your previous motion problems—such as those involving constant acceleration—you learned how to determine an object’s trajectory using deterministic equations.
            These equations, like the one below, describe an object’s position as a function of time:
          </p>

          <div id="eq-kinematics">
            <p>
              $$\begin{equation}
                \vec{x} = \vec{x}_0 + \vec{v}t + \frac{1}{2}\vec{a}t^2 \label{eq:kinematics}
              \end{equation}$$
            </p>
          </div>

          <p>
            This kind of motion is deterministic: if you repeat the experiment with the same starting conditions, the object will follow the same path every time.
            Whether it’s an apple falling from a tree, a cannonball arcing through the air, or a car accelerating at a constant rate, the outcome is predictable.
          </p>

          <p>
            Brownian motion, however, is fundamentally different. It is not deterministic—instead, it is random.
            A particle undergoing Brownian motion doesn’t follow a predictable path.
            At any given instant, it is equally likely to move in any direction.
            As a result, there’s no single equation, like <a href="#eq-kinematics" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:kinematics}$</a>, that can describe its position over time.
          </p>

          <p>
            Instead of a smooth, repeatable trajectory, a Brownian particle follows a random walk—a path built from a series of unpredictable, jittery steps in different directions.
            Each time the experiment is run, the particle traces a different path (see  <a href="#fig-1" class="text-blue-300 hover:underline"><strong>Figure 1</strong></a>), even if the starting conditions are identical.
          </p>

          <figure id="fig-1" class="my-8 text-center">
            <img
              src="figures/lab1/figure1.png"
              alt="Examples of random walks"
              class="mx-auto rounded"
            />
            <figcaption class="mt-2 text-sm text-gray-400">
              <strong>Figure 1:</strong> Examples of 2D random walks. These three particles were all subject to the exact same motion constraints, yet follow entirely different paths.
            </figcaption>
          </figure>

          <p>
            Although the motion of a particle undergoing Brownian motion is entirely unpredictable, this does not mean it is beyond description — it simply requires a shift in perspective.
            Rather than attempting to write an equation that deterministically describes the path of a single particle (which is not possible due to the inherently random nature of its motion), we focus instead on the statistical behavior that emerges across many particles or repeated trials.
          </p>

          <p>
            In the interactive panel below, you can simulate individual particles undergoing a two-dimensional random walk.
            Each time you click the 'Start Random Walk' button, a new trajectory is generated.
            The particle begins at the center and moves randomly for 100 steps.
            The resulting path is displayed on the left, and will differ each time due to the randomness of the motion.
          </p>

          <p>
            As you generate more walks, observe the two histograms on the right. These track the final $x$ and $y$ positions of the particles.
            Although no single outcome can be predicted in advance, a statistical pattern gradually emerges: the positions begin to cluster in a familiar bell-shaped curve, known as the <strong>Gaussian</strong> (or <strong>normal</strong>) distribution.
          </p>

          <div class="flex justify-center items-start" style="gap: 10px;">
            <!-- Left: Trajectory Panel -->
            <div>
              <canvas
                id="histogramWalkCanvas"
                width="300"
                height="300"
                class="bg-gray-800 border border-gray-600 rounded"
              ></canvas>
            </div>

            <!-- Right: Stacked Histograms with exact spacing -->
            <div class="flex flex-col justify-between" style="height: 300px; gap: 10px;">
              <canvas
                id="xFinalHistogram"
                width="300"
                height="144"
                class="bg-gray-800 border border-gray-600 rounded"
              ></canvas>
              <canvas
                id="yFinalHistogram"
                width="300"
                height="144"
                class="bg-gray-800 border border-gray-600 rounded"
              ></canvas>
            </div>
          </div>

          <!-- Buttons -->
          <div class="flex justify-center items-start" style="margin-top: 10px; gap: 4px;">
            <button
              id="startHistogramWalk"
              class="px-4 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-500 transition"
              style="margin: 0;"
            >
              Start Random Walk
            </button>
            <button
              id="resetHistogramWalk"
              class="px-4 py-2 bg-gray-600 text-white font-semibold rounded hover:bg-gray-500 transition"
              style="margin: 0;"
            >
              Reset
            </button>
          </div>
          </div>

          <script>
            const histCanvas = document.getElementById("histogramWalkCanvas");
            const histCtx = histCanvas.getContext("2d");
            const startHistogramWalk = document.getElementById("startHistogramWalk");
            const resetHistogramWalk = document.getElementById("resetHistogramWalk");

            const xFinalCanvas = document.getElementById("xFinalHistogram");
            const yFinalCanvas = document.getElementById("yFinalHistogram");
            const xFinalCtx = xFinalCanvas.getContext("2d");
            const yFinalCtx = yFinalCanvas.getContext("2d");

            const histCanvasSize = 300;
            const histSteps = 100;
            const histScale = (histCanvasSize / 2 - 20) / (2 * Math.sqrt(histSteps));

            let finalXValues = [];
            let finalYValues = [];

            let walkCount = 0;

            // Create an offscreen buffer to store faded trails
            let trailBuffer = document.createElement('canvas');
            trailBuffer.width = histCanvas.width;
            trailBuffer.height = histCanvas.height;
            let trailCtx = trailBuffer.getContext('2d');

            const binMin = -25;
            const binMax = 25;
            const binWidth = 2;
            const binCount = (binMax - binMin) / binWidth;

            function drawHistogram(data, ctx, color, labelText) {
              ctx.clearRect(0, 0, 300, 145);

              // Label at top-left
              ctx.fillStyle = 'white';
              ctx.font = '12px sans-serif';
              ctx.textAlign = 'left';
              ctx.fillText(labelText, 5, 15);

              const bins = new Array(binCount).fill(0);
              data.forEach(value => {
                const index = Math.floor((value - binMin) / binWidth);
                if (index >= 0 && index < binCount) bins[index]++;
              });

              const barWidth = 300 / binCount;
              const maxCount = Math.max(...bins);

              // Draw bars
              for (let i = 0; i < binCount; i++) {
                const height = (bins[i] / maxCount) * 100;
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(i * barWidth, 120 - height, barWidth - 1, height);
              }

              // Axis line
              ctx.strokeStyle = 'white';
              ctx.lineWidth = 1;
              ctx.beginPath();
              ctx.moveTo(0, 120);
              ctx.lineTo(300, 120);
              ctx.stroke();

              // Tick labels at defined values (excluding ±25)
              const tickValues = [-20, -15, -10, -5, 0, 5, 10, 15, 20];
              ctx.fillStyle = 'white';
              ctx.font = '10px sans-serif';
              ctx.textAlign = 'center';
              tickValues.forEach(val => {
                const idx = (val - binMin) / binWidth;
                const xPos = idx * barWidth + barWidth / 2;
                ctx.fillText(val.toString(), xPos, 135);
              });
            }

            startHistogramWalk.addEventListener("click", () => {
              let x = 0;
              let y = 0;
              let path = [{ x, y }];
              let step = 0;

              trailCtx.clearRect(0, 0, trailBuffer.width, trailBuffer.height);
              trailCtx.drawImage(histCanvas, 0, 0);

              histCtx.clearRect(0, 0, histCanvas.width, histCanvas.height);
              histCtx.globalAlpha = 0.95;
              histCtx.drawImage(trailBuffer, 0, 0);
              histCtx.globalAlpha = 1.0;

              walkCount++;

              const interval = setInterval(() => {
                const direction = Math.floor(Math.random() * 4);
                switch (direction) {
                  case 0: x += 1; break;
                  case 1: x -= 1; break;
                  case 2: y += 1; break;
                  case 3: y -= 1; break;
                }

                const prev = path[path.length - 1];
                const hue = (step / histSteps) * 360;

                histCtx.beginPath();
                histCtx.moveTo(histCanvasSize / 2 + prev.x * histScale, histCanvasSize / 2 + prev.y * histScale);
                histCtx.lineTo(histCanvasSize / 2 + x * histScale, histCanvasSize / 2 + y * histScale);
                histCtx.strokeStyle = `hsl(${hue}, 100%, 65%)`;
                histCtx.lineWidth = 2;
                histCtx.stroke();

                path.push({ x, y });
                step++;

                if (step >= histSteps) {
                  clearInterval(interval);
                  finalXValues.push(x);
                  finalYValues.push(y);
                  drawHistogram(finalXValues, xFinalCtx, 'cyan', 'Final X');
                  drawHistogram(finalYValues, yFinalCtx, 'magenta', 'Final Y');
                }
              }, 1);
            });

            resetHistogramWalk.addEventListener("click", () => {
              histCtx.clearRect(0, 0, histCanvas.width, histCanvas.height);
              xFinalCtx.clearRect(0, 0, xFinalCanvas.width, xFinalCanvas.height);
              yFinalCtx.clearRect(0, 0, yFinalCanvas.width, yFinalCanvas.height);
              finalXValues = [];
              finalYValues = [];
            });
          </script>

          <p>
          </p>

          <p>
            The general form of the Gaussian distribution is
          </p>

          <div id="eq-gaussian">
            <p>
              $$\begin{equation}
                f(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp{\left[{-\frac{1}{2}\left( \frac{x-\mu}{\sigma} \right)^2}\right]}\,. \label{eq:gaussian}
              \end{equation}$$
            </p>
          </div>

          <p>
            Here, $\mu$ is the <strong>mean</strong> (or <strong>average</strong>) of the distribution, and $\sigma$ is the <strong>standard deviation</strong> (SD), a measure of the variation from the mean.
            The mean of this particular distribution from our random walk trials is 0, so we can slightly simplify <a href="#eq-gaussian" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:gaussian}$</a> to construct a probability density function for our particle displacements ($\Delta x$),
          </p>

          <div id="eq-pdf">
            <p>
              $$\begin{equation}
                f(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp{\left( -\frac{x^2}{2\sigma^2} \right)}\,. \label{eq:pdf}
              \end{equation}$$
            </p>
          </div>

          <p>
            This function takes a particle displacement as an input and returns its probability of occurence.
            Probability density functions are everywhere in quantum mechanics, so you will see many more of them throughout the rest of your physics education.
          </p>

          <p>
            The standard deviation of a dataset with a mean of 0 is obtained by squaring all entries, taking the mean of the squares, then taking the square root of this mean.
            You may be familiar with the <strong>root-mean-square</strong> (RMS) from the surface-level discussions of the kinetic molecular theory of gases in your introductory physics courses.
            In datasets with means of 0, the RMS and SD are identical.
            So, for our set of particle displacements,
          </p>

          <div id="eq-sd-long">
            <p>
              $$\begin{equation}
                \sigma = \sqrt{\frac{1}{N}\displaystyle\sum_{i=1}^N\left( \Delta x_i \right)^2}\,. \label{eq:sd-long}
              \end{equation}$$
            </p>
          </div>

          <p>
            A common shorthand notation for the above equation is
          </p>

          <div id="eq-sd-short">
            <p>
              $$\begin{equation}
                \sigma = \sqrt{\langle \Delta x^2 \rangle}\,. \label{eq:sd-short}
              \end{equation}$$
            </p>
          </div>

          <p>
            It is important to note that this $\Delta x^2$ quantity inside the angled brackets in <a href="#eq-sd-short" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:sd-short}$</a> is not the same as the $\Delta x^2$ quantity shown explicitly in the exponential in <a href="#eq-pdf" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:pdf}$</a>.
            The angled brackets in <a href="#eq-sd-short" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:sd-short}$</a> indicate that a mean is being taken over the entire dataset, while the $\Delta x^2$ in <a href="#eq-pdf" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:pdf}$</a> is simply the square of a single particle displacement.
          </p>

          <p>
            Equipped with this knowledge, we could use <a href="#eq-sd-long" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:sd-long}$</a> on our set of 500,000 random walks to determine the standard deviation that appears in <a href="#eq-pdf" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:pdf}$</a>, and we would then have a complete probability density function.
            This is useful for predicting statistical behavior of these particles undergoing Brownian motion, but it is ultimately nothing but mathematics.
            The Gaussian distribution tells us nothing about why the particles are moving the way they are moving - it only tells us how they are moving.
            To understand why, we must turn our attention back to physics as Einstein did over 100 years ago.
          </p>

          <p>
            If you’ve ever placed a drop of dye into a clear glass of water, you’ve witnessed the slow and steady spread of color, gradually billowing outwards until it is eventually uniformly distributed throughout.
            This is a perfect example of <strong>diffusion</strong> - the net movement of particles from regions of higher concentration to lower concentration.
            This process is driven by Brownian motion as molecules are continually colliding with each other, bouncing off in random directions and traveling ever greater distances in the absence of frequent collisions.
            Einstein was able to demonstrate this connection by showing that the 1D number density $\rho(x, t)$ of Brownian particles satisfies the diffusion equation,
          </p>

          <div id="eq-diffusion">
            <p>
              $$\begin{equation}
                \frac{\partial \rho}{\partial t} = D \cdot \frac{\partial^2\rho}{\partial x^2}\,. \label{eq:diffusion}
              \end{equation}$$
            </p>
          </div>

          <p>
            Here, $D$ is called the <strong>diffusion coefficient</strong>.
            Solving this differential equation for $\rho(x, t)$ for a system of $N$ particles yields the somewhat familiar-looking result
          </p>

          <div id="eq-concentration">
            <p>
              $$\begin{equation}
                \rho(x, t) = \frac{N}{\sqrt{4\pi D t}}\exp{\left[ -\frac{x^2}{4Dt} \right]}\,. \label{eq:concentration}
              \end{equation}$$
            </p>
          </div>

          <p>
            This is a Gaussian distribution, very much like the one we saw earlier in our mathematical description of Brownian motion.
            In fact, if we compare <a href="#eq-concentration" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:concentration}$</a> to <a href="#eq-pdf" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:pdf}$</a>, and use what we know from <a href="#eq-sd-short" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:sd-short}$</a>, we obtain the following relation:
          </p>

          <div id="eq-position-time">
            <p>
              $$\begin{equation}
                \boxed{\langle \Delta x^2 \rangle = 2Dt}\,. \label{eq:position-time}
              \end{equation}$$
            </p>
          </div>

          <p>
            This shows that the mean displacement of particles undergoing Brownian motion is not proportional to the elapsed time, but rather to the <em>square root</em> of the elapsed time, contrary to what was then conventional wisdom.
          </p>

          <p>
            Einstein also noticed that there was a fundamental connection between the Brownian motion of particles and the drag forces that act on them.
            As stated earlier, Brownian motion arises when particles submersed in a fluid are knocked around by the molecules comprising the fluid itself.
            This process converts thermal energy (the fluctuations of the fluid molecules) into kinetic energy (the motion of the particles submersed in the fluid).
          </p>

          <p>
            Drag forces do the opposite of this.
            As an object moves through a fluid, it loses its kinetic energy in the form of heat as it collides with the fluid molecules.
            Such drag forces act on particles undergoing Brownian motion as well, resulting in a perpetual exchange of kinetic and thermal energy between these particles and the surrounding fluid.
            Einstein showed that these energy exchanges are concisely captured by the relation
          </p>

          <div id="eq-einstein-relation">
            <p>
              $$\begin{equation}
                Df = k_BT\,. \label{eq:einstein-relation}
              \end{equation}$$
            </p>
          </div>

          <p>
            Here, $f$ is the <strong>drag coefficient</strong>, $T$ is the temperature of the fluid, and $k_B$ is <strong>Boltzmann's constant</strong>.
            According to Stokes' Law, the drag coefficient for a sphere of radius $r$ moving through a fluid of viscosity $\eta$ is given by
          </p>

          <div id="eq-stokes">
            <p>
              $$\begin{equation}
                f = 6\pi\eta r\,. \label{eq:stokes}
              \end{equation}$$
            </p>
          </div>

          <p>
            Thus, <a href="#eq-einstein-relation" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:einstein-relation}$</a> becomes
          </p>

          <div id="eq-diffusion-coefficient">
            <p>
              $$\begin{equation}
                D = \frac{k_BT}{6\pi\eta r}\,. \label{eq:diffusion-coefficient}
              \end{equation}$$
            </p>
          </div>

          <p>
            Since Boltzmann's constant is equal to the gas constant $R$ divided by Avogadro's number $N_A$, <a href="#eq-diffusion-coefficient" class="text-blue-300 font-bold hover:underline"> Equation $\ref{eq:diffusion-coefficient}$</a> can be rewritten as
          </p>

          <div id="eq-avogadro">
            <p>
              $$\begin{equation}
                \boxed{N_A = \frac{RT}{6\pi\eta r D}}\,. \label{eq:avogadro}
              \end{equation}$$
            </p>
          </div>

        </div>
      </details>



      <!-- Section: Pre-Lab Questions -->
      <details id="pre-lab-questions" class="mb-8">
        <summary class="text-xl font-bold cursor-pointer hover:text-blue-300">
          Pre-Lab Questions
        </summary>
        <div class="mt-4 space-y-6">

        <ol class="list-decimal space-y-4 pl-6">
          <li>
            <p>
              Prove by direct substitution that $\rho(x, t)$ from
              <a href="#eq-concentration" class="text-blue-300 font-bold hover:underline">Equation $\ref{eq:concentration}$</a>
              is a solution to
              <a href="#eq-diffusion" class="text-blue-300 font-bold hover:underline">Equation $\ref{eq:diffusion}$</a>.
            </p>
          </li>
        </ol>
        <p class="mt-6">
          The next questions relate to <a href="data/lab1/brownian_motion_prelab_data.csv" download class="text-blue-300 font-bold hover:underline">this CSV file</a> - download it before proceeding.
        </p>
        <ol class="list-decimal space-y-4 pl-6" start="2">
          <li>
            <p>
              Plot a histogram of the data.
              What type of distribution do you think best models this data?
            </p>
          </li>
          <li>
            <p>
              What is the standard deviation of the data?
            </p>
          </li>
          <li>
            <p>
              What is the root-mean-square of the data?
            </p>
          </li>
          <li>
            <p>
              The standard deviation and root-mean-square of the data should be very similar, but slightly different.
              What is the reason for this slight difference?
            </p>
          </li>
        </ol>

      </div>
    </details>



      <!-- Section: Footnotes -->
      <footer class="mt-8 text-sm text-gray-400 space-y-1">

        <p id="feynman-1963">
          [1] Richard P. Feynman, <em>The Feynman Lectures on Physics</em>, Vol. I, Chapter 1: "Atoms in Motion", Addison-Wesley (1963).
        </p>

        <p id="brown-1828">
          [2] R. Brown, "A brief Account of Microscopical Observations...", <em>Philos. Mag.</em> 4(21), 161–173 (1828).
        </p>

        <p id="einstein-1956">
          [3] A. Einstein, <em>Investigations on the Theory of Brownian Movement</em>, translated by A. D. Cowper (Dover, New York, 1956).
        </p>

        <p id="perrin-1910">
          [4] J. Perrin, "Brownian movement and molecular reality", translated by F. Soddy (Taylor and Francis, London, 1910).
        </p>

      </footer>



    </main>
  </body>
</html>